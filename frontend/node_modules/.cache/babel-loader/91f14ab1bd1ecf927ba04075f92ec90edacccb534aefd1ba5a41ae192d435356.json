{"ast":null,"code":"import axios from\"../axios\";import React,{useRef,useState}from\"react\";import{Navbar,Button,Nav,NavDropdown,Container}from\"react-bootstrap\";import{useDispatch,useSelector}from\"react-redux\";import{LinkContainer}from\"react-router-bootstrap\";import{logout,resetNotifications}from\"../features/userSlice\";import\"./Navigation.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Navigation(){var _user$notifications;const user=useSelector(state=>state.user);const dispatch=useDispatch();const bellRef=useRef(null);const notificationRef=useRef(null);const[bellPos,setBellPos]=useState({});function handleLogout(){dispatch(logout());}const unreadNotifications=user===null||user===void 0?void 0:(_user$notifications=user.notifications)===null||_user$notifications===void 0?void 0:_user$notifications.reduce((acc,current)=>{if(current.status==\"unread\")return acc+1;return acc;},0);function handleToggleNotifications(){const position=bellRef.current.getBoundingClientRect();setBellPos(position);notificationRef.current.style.display=notificationRef.current.style.display===\"block\"?\"none\":\"block\";dispatch(resetNotifications());if(unreadNotifications>0)axios.post(\"/users/\".concat(user._id,\"/updateNotifications\"));}return/*#__PURE__*/_jsxs(Navbar,{bg:\"light\",expand:\"lg\",children:[/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(LinkContainer,{to:\"/\",children:/*#__PURE__*/_jsx(Navbar.Brand,{children:\"Ecomern\"})}),/*#__PURE__*/_jsx(Navbar.Toggle,{\"aria-controls\":\"basic-navbar-nav\"}),/*#__PURE__*/_jsx(Navbar.Collapse,{id:\"basic-navbar-nav\",children:/*#__PURE__*/_jsxs(Nav,{className:\"ms-auto\",children:[!user&&/*#__PURE__*/_jsx(LinkContainer,{to:\"/login\",children:/*#__PURE__*/_jsx(Nav.Link,{children:\"Login\"})}),user&&!user.isAdmin&&/*#__PURE__*/_jsx(LinkContainer,{to:\"/cart\",children:/*#__PURE__*/_jsxs(Nav.Link,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-shopping-cart\"}),(user===null||user===void 0?void 0:user.cart.count)>0&&/*#__PURE__*/_jsx(\"span\",{className:\"badge badge-warning\",id:\"cartcount\",children:user.cart.count})]})}),user&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Nav.Link,{style:{position:\"relative\"},onClick:handleToggleNotifications,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-bell\",ref:bellRef,\"data-count\":unreadNotifications||null})}),/*#__PURE__*/_jsxs(NavDropdown,{title:\"\".concat(user.email),id:\"basic-nav-dropdown\",children:[user.isAdmin&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LinkContainer,{to:\"/admin\",children:/*#__PURE__*/_jsx(NavDropdown.Item,{children:\"Dashboard\"})}),/*#__PURE__*/_jsx(LinkContainer,{to:\"/new-product\",children:/*#__PURE__*/_jsx(NavDropdown.Item,{children:\"Create Product\"})})]}),!user.isAdmin&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LinkContainer,{to:\"/cart\",children:/*#__PURE__*/_jsx(NavDropdown.Item,{children:\"Cart\"})}),/*#__PURE__*/_jsx(LinkContainer,{to:\"/orders\",children:/*#__PURE__*/_jsx(NavDropdown.Item,{children:\"My orders\"})})]}),/*#__PURE__*/_jsx(NavDropdown.Divider,{}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:handleLogout,className:\"logout-btn\",children:\"Logout\"})]})]})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"notifications-container\",ref:notificationRef,style:{position:\"absolute\",top:bellPos.top+30,left:bellPos.left,display:\"none\"},children:(user===null||user===void 0?void 0:user.notifications.length)>0?user===null||user===void 0?void 0:user.notifications.map(notification=>/*#__PURE__*/_jsxs(\"p\",{className:\"notification-\".concat(notification.status),children:[notification.message,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:notification.time.split(\"T\")[0]+\" \"+notification.time.split(\"T\")[1]})]})):/*#__PURE__*/_jsx(\"p\",{children:\"No notifcations yet\"})})]});}export default Navigation;","map":{"version":3,"names":["axios","React","useRef","useState","Navbar","Button","Nav","NavDropdown","Container","useDispatch","useSelector","LinkContainer","logout","resetNotifications","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Navigation","_user$notifications","user","state","dispatch","bellRef","notificationRef","bellPos","setBellPos","handleLogout","unreadNotifications","notifications","reduce","acc","current","status","handleToggleNotifications","position","getBoundingClientRect","style","display","post","concat","_id","bg","expand","children","to","Brand","Toggle","Collapse","id","className","Link","isAdmin","cart","count","onClick","ref","title","email","Item","Divider","variant","top","left","length","map","notification","message","time","split"],"sources":["C:/Users/91637/OneDrive/Desktop/E-commerce/frontend/src/components/Navigation.js"],"sourcesContent":["import axios from \"../axios\";\r\nimport React, { useRef, useState } from \"react\";\r\nimport { Navbar, Button, Nav, NavDropdown, Container } from \"react-bootstrap\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { LinkContainer } from \"react-router-bootstrap\";\r\nimport { logout, resetNotifications } from \"../features/userSlice\";\r\nimport \"./Navigation.css\";\r\n\r\nfunction Navigation() {\r\n    const user = useSelector((state) => state.user);\r\n    const dispatch = useDispatch();\r\n    const bellRef = useRef(null);\r\n    const notificationRef = useRef(null);\r\n    const [bellPos, setBellPos] = useState({});\r\n\r\n    function handleLogout() {\r\n        dispatch(logout());\r\n    }\r\n    const unreadNotifications = user?.notifications?.reduce((acc, current) => {\r\n        if (current.status == \"unread\") return acc + 1;\r\n        return acc;\r\n    }, 0);\r\n\r\n    function handleToggleNotifications() {\r\n        const position = bellRef.current.getBoundingClientRect();\r\n        setBellPos(position);\r\n        notificationRef.current.style.display = notificationRef.current.style.display === \"block\" ? \"none\" : \"block\";\r\n        dispatch(resetNotifications());\r\n        if (unreadNotifications > 0) axios.post(`/users/${user._id}/updateNotifications`);\r\n    }\r\n\r\n    return (\r\n        <Navbar bg=\"light\" expand=\"lg\">\r\n            <Container>\r\n                <LinkContainer to=\"/\">\r\n                    <Navbar.Brand>Ecomern</Navbar.Brand>\r\n                </LinkContainer>\r\n                <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\r\n                <Navbar.Collapse id=\"basic-navbar-nav\">\r\n                    <Nav className=\"ms-auto\">\r\n                        {/* if no user */}\r\n                        {!user && (\r\n                            <LinkContainer to=\"/login\">\r\n                                <Nav.Link>Login</Nav.Link>\r\n                            </LinkContainer>\r\n                        )}\r\n                        {user && !user.isAdmin && (\r\n                            <LinkContainer to=\"/cart\">\r\n                                <Nav.Link>\r\n                                    <i className=\"fas fa-shopping-cart\"></i>\r\n                                    {user?.cart.count > 0 && (\r\n                                        <span className=\"badge badge-warning\" id=\"cartcount\">\r\n                                            {user.cart.count}\r\n                                        </span>\r\n                                    )}\r\n                                </Nav.Link>\r\n                            </LinkContainer>\r\n                        )}\r\n\r\n                        {/* if user */}\r\n                        {user && (\r\n                            <>\r\n                                <Nav.Link style={{ position: \"relative\" }} onClick={handleToggleNotifications}>\r\n                                    <i className=\"fas fa-bell\" ref={bellRef} data-count={unreadNotifications || null}></i>\r\n                                </Nav.Link>\r\n                                <NavDropdown title={`${user.email}`} id=\"basic-nav-dropdown\">\r\n                                    {user.isAdmin && (\r\n                                        <>\r\n                                            <LinkContainer to=\"/admin\">\r\n                                                <NavDropdown.Item>Dashboard</NavDropdown.Item>\r\n                                            </LinkContainer>\r\n                                            <LinkContainer to=\"/new-product\">\r\n                                                <NavDropdown.Item>Create Product</NavDropdown.Item>\r\n                                            </LinkContainer>\r\n                                        </>\r\n                                    )}\r\n                                    {!user.isAdmin && (\r\n                                        <>\r\n                                            <LinkContainer to=\"/cart\">\r\n                                                <NavDropdown.Item>Cart</NavDropdown.Item>\r\n                                            </LinkContainer>\r\n                                            <LinkContainer to=\"/orders\">\r\n                                                <NavDropdown.Item>My orders</NavDropdown.Item>\r\n                                            </LinkContainer>\r\n                                        </>\r\n                                    )}\r\n\r\n                                    <NavDropdown.Divider />\r\n                                    <Button variant=\"danger\" onClick={handleLogout} className=\"logout-btn\">\r\n                                        Logout\r\n                                    </Button>\r\n                                </NavDropdown>\r\n                            </>\r\n                        )}\r\n                    </Nav>\r\n                </Navbar.Collapse>\r\n            </Container>\r\n            {/* notifications */}\r\n            <div className=\"notifications-container\" ref={notificationRef} style={{ position: \"absolute\", top: bellPos.top + 30, left: bellPos.left, display: \"none\" }}>\r\n                {user?.notifications.length > 0 ? (\r\n                    user?.notifications.map((notification) => (\r\n                        <p className={`notification-${notification.status}`}>\r\n                            {notification.message}\r\n                            <br />\r\n                            <span>{notification.time.split(\"T\")[0] + \" \" + notification.time.split(\"T\")[1]}</span>\r\n                        </p>\r\n                    ))\r\n                ) : (\r\n                    <p>No notifcations yet</p>\r\n                )}\r\n            </div>\r\n        </Navbar>\r\n    );\r\n}\r\n\r\nexport default Navigation;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}