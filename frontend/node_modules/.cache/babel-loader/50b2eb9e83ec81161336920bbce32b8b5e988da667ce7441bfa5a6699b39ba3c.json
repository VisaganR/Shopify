{"ast":null,"code":"import React,{useState}from\"react\";import{Alert,Col,Container,Form,Row,Button}from\"react-bootstrap\";import{useNavigate}from\"react-router-dom\";import{useCreateProductMutation}from\"../services/appApi\";import axios from\"../axios\";import\"./NewProduct.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function NewProduct(){const[name,setName]=useState(\"\");const[description,setDescription]=useState(\"\");const[price,setPrice]=useState(\"\");const[category,setCategory]=useState(\"\");const[images,setImages]=useState([]);const[imgToRemove,setImgToRemove]=useState(null);const navigate=useNavigate();const[createProduct,{isError,error,isLoading,isSuccess}]=useCreateProductMutation();function handleRemoveImg(imgObj){setImgToRemove(imgObj.public_id);axios.delete(\"/images/\".concat(imgObj.public_id,\"/\")).then(res=>{setImgToRemove(null);setImages(prev=>prev.filter(img=>img.public_id!==imgObj.public_id));}).catch(e=>console.log(e));}function handleSubmit(e){e.preventDefault();if(!name||!description||!price||!category||!images.length){return alert(\"Please fill out all the fields\");}createProduct({name,description,price,category,images}).then(_ref=>{let{data}=_ref;if(data.length>0){setTimeout(()=>{navigate(\"/\");},1500);}});}function showWidget(){const widget=window.cloudinary.createUploadWidget({cloudName:\"learn-code-10\",uploadPreset:\"dcizdwph\"},(error,result)=>{if(!error&&result.event===\"success\"){setImages(prev=>[...prev,{url:result.info.url,public_id:result.info.public_id}]);}});widget.open();}return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,className:\"new-product__form--container\",children:/*#__PURE__*/_jsxs(Form,{style:{width:\"100%\"},onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mt-4\",children:\"Create a product\"}),isSuccess&&/*#__PURE__*/_jsx(Alert,{variant:\"success\",children:\"Product created with succcess\"}),isError&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error.data}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Product name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Enter product name\",value:name,required:true,onChange:e=>setName(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Product description\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",placeholder:\"Product description\",style:{height:\"100px\"},value:description,required:true,onChange:e=>setDescription(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Price($)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"Price ($)\",value:price,required:true,onChange:e=>setPrice(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",onChange:e=>setCategory(e.target.value),children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Category\"}),/*#__PURE__*/_jsxs(Form.Select,{children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,selected:true,children:\"-- Select One --\"}),/*#__PURE__*/_jsx(\"option\",{value:\"technology\",children:\"technology\"}),/*#__PURE__*/_jsx(\"option\",{value:\"tablets\",children:\"tablets\"}),/*#__PURE__*/_jsx(\"option\",{value:\"phones\",children:\"phones\"}),/*#__PURE__*/_jsx(\"option\",{value:\"laptops\",children:\"laptops\"})]})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Button,{type:\"button\",onClick:showWidget,children:\"Upload Images\"}),/*#__PURE__*/_jsx(\"div\",{className:\"images-preview-container\",children:images.map(image=>/*#__PURE__*/_jsxs(\"div\",{className:\"image-preview\",children:[/*#__PURE__*/_jsx(\"img\",{src:image.url}),imgToRemove!=image.public_id&&/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-times-circle\",onClick:()=>handleRemoveImg(image)})]}))})]}),/*#__PURE__*/_jsx(Form.Group,{children:/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:isLoading||isSuccess,children:\"Create Product\"})})]})}),/*#__PURE__*/_jsx(Col,{md:6,className:\"new-product__image--container\"})]})});}export default NewProduct;","map":{"version":3,"names":["React","useState","Alert","Col","Container","Form","Row","Button","useNavigate","useCreateProductMutation","axios","jsx","_jsx","jsxs","_jsxs","NewProduct","name","setName","description","setDescription","price","setPrice","category","setCategory","images","setImages","imgToRemove","setImgToRemove","navigate","createProduct","isError","error","isLoading","isSuccess","handleRemoveImg","imgObj","public_id","delete","concat","then","res","prev","filter","img","catch","e","console","log","handleSubmit","preventDefault","length","alert","_ref","data","setTimeout","showWidget","widget","window","cloudinary","createUploadWidget","cloudName","uploadPreset","result","event","url","info","open","children","md","className","style","width","onSubmit","variant","Group","Label","Control","type","placeholder","value","required","onChange","target","as","height","Select","disabled","selected","onClick","map","image","src"],"sources":["C:/Users/91637/OneDrive/Desktop/E-commerce/frontend/src/pages/NewProduct.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { Alert, Col, Container, Form, Row, Button } from \"react-bootstrap\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useCreateProductMutation } from \"../services/appApi\";\r\nimport axios from \"../axios\";\r\nimport \"./NewProduct.css\";\r\n\r\nfunction NewProduct() {\r\n    const [name, setName] = useState(\"\");\r\n    const [description, setDescription] = useState(\"\");\r\n    const [price, setPrice] = useState(\"\");\r\n    const [category, setCategory] = useState(\"\");\r\n    const [images, setImages] = useState([]);\r\n    const [imgToRemove, setImgToRemove] = useState(null);\r\n    const navigate = useNavigate();\r\n    const [createProduct, { isError, error, isLoading, isSuccess }] = useCreateProductMutation();\r\n\r\n    function handleRemoveImg(imgObj) {\r\n        setImgToRemove(imgObj.public_id);\r\n        axios\r\n            .delete(`/images/${imgObj.public_id}/`)\r\n            .then((res) => {\r\n                setImgToRemove(null);\r\n                setImages((prev) => prev.filter((img) => img.public_id !== imgObj.public_id));\r\n            })\r\n            .catch((e) => console.log(e));\r\n    }\r\n\r\n    function handleSubmit(e) {\r\n        e.preventDefault();\r\n        if (!name || !description || !price || !category || !images.length) {\r\n            return alert(\"Please fill out all the fields\");\r\n        }\r\n        createProduct({ name, description, price, category, images }).then(({ data }) => {\r\n            if (data.length > 0) {\r\n                setTimeout(() => {\r\n                    navigate(\"/\");\r\n                }, 1500);\r\n            }\r\n        });\r\n    }\r\n\r\n    function showWidget() {\r\n        const widget = window.cloudinary.createUploadWidget(\r\n            {\r\n                cloudName: \"learn-code-10\",\r\n                uploadPreset: \"dcizdwph\",\r\n            },\r\n            (error, result) => {\r\n                if (!error && result.event === \"success\") {\r\n                    setImages((prev) => [...prev, { url: result.info.url, public_id: result.info.public_id }]);\r\n                }\r\n            }\r\n        );\r\n        widget.open();\r\n    }\r\n\r\n    return (\r\n        <Container>\r\n            <Row>\r\n                <Col md={6} className=\"new-product__form--container\">\r\n                    <Form style={{ width: \"100%\" }} onSubmit={handleSubmit}>\r\n                        <h1 className=\"mt-4\">Create a product</h1>\r\n                        {isSuccess && <Alert variant=\"success\">Product created with succcess</Alert>}\r\n                        {isError && <Alert variant=\"danger\">{error.data}</Alert>}\r\n                        <Form.Group className=\"mb-3\">\r\n                            <Form.Label>Product name</Form.Label>\r\n                            <Form.Control type=\"text\" placeholder=\"Enter product name\" value={name} required onChange={(e) => setName(e.target.value)} />\r\n                        </Form.Group>\r\n\r\n                        <Form.Group className=\"mb-3\">\r\n                            <Form.Label>Product description</Form.Label>\r\n                            <Form.Control as=\"textarea\" placeholder=\"Product description\" style={{ height: \"100px\" }} value={description} required onChange={(e) => setDescription(e.target.value)} />\r\n                        </Form.Group>\r\n\r\n                        <Form.Group className=\"mb-3\">\r\n                            <Form.Label>Price($)</Form.Label>\r\n                            <Form.Control type=\"number\" placeholder=\"Price ($)\" value={price} required onChange={(e) => setPrice(e.target.value)} />\r\n                        </Form.Group>\r\n\r\n                        <Form.Group className=\"mb-3\" onChange={(e) => setCategory(e.target.value)}>\r\n                            <Form.Label>Category</Form.Label>\r\n                            <Form.Select>\r\n                                <option disabled selected>\r\n                                    -- Select One --\r\n                                </option>\r\n                                <option value=\"technology\">technology</option>\r\n                                <option value=\"tablets\">tablets</option>\r\n                                <option value=\"phones\">phones</option>\r\n                                <option value=\"laptops\">laptops</option>\r\n                            </Form.Select>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group className=\"mb-3\">\r\n                            <Button type=\"button\" onClick={showWidget}>\r\n                                Upload Images\r\n                            </Button>\r\n                            <div className=\"images-preview-container\">\r\n                                {images.map((image) => (\r\n                                    <div className=\"image-preview\">\r\n                                        <img src={image.url} />\r\n                                        {imgToRemove != image.public_id && <i className=\"fa fa-times-circle\" onClick={() => handleRemoveImg(image)}></i>}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group>\r\n                            <Button type=\"submit\" disabled={isLoading || isSuccess}>\r\n                                Create Product\r\n                            </Button>\r\n                        </Form.Group>\r\n                    </Form>\r\n                </Col>\r\n                <Col md={6} className=\"new-product__image--container\"></Col>\r\n            </Row>\r\n        </Container>\r\n    );\r\n}\r\n\r\nexport default NewProduct;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}