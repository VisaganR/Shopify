{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{Badge,Button,Modal,Table}from\"react-bootstrap\";import{useSelector}from\"react-redux\";import axios from\"../axios\";import Loading from\"./Loading\";import Pagination from\"./Pagination\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function OrdersAdminPage(){const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(false);const products=useSelector(state=>state.products);const[orderToShow,setOrderToShow]=useState([]);const[show,setShow]=useState(false);const handleClose=()=>setShow(false);function markShipped(orderId,ownerId){axios.patch(\"/orders/\".concat(orderId,\"/mark-shipped\"),{ownerId}).then(_ref=>{let{data}=_ref;return setOrders(data);}).catch(e=>console.log(e));}function showOrder(productsObj){let productsToShow=products.filter(product=>productsObj[product._id]);productsToShow=productsToShow.map(product=>{const productCopy={...product};productCopy.count=productsObj[product._id];delete productCopy.description;return productCopy;});console.log(productsToShow);setShow(true);setOrderToShow(productsToShow);}useEffect(()=>{setLoading(true);axios.get(\"/orders\").then(_ref2=>{let{data}=_ref2;setLoading(false);setOrders(data);}).catch(e=>{setLoading(false);});},[]);if(loading){return/*#__PURE__*/_jsx(Loading,{});}if(orders.length===0){return/*#__PURE__*/_jsx(\"h1\",{className:\"text-center pt-4\",children:\"No orders yet\"});}function TableRow(_ref3){let{_id,count,owner,total,status,products,address}=_ref3;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:_id}),/*#__PURE__*/_jsx(\"td\",{children:owner===null||owner===void 0?void 0:owner.name}),/*#__PURE__*/_jsx(\"td\",{children:count}),/*#__PURE__*/_jsx(\"td\",{children:total}),/*#__PURE__*/_jsx(\"td\",{children:address}),/*#__PURE__*/_jsx(\"td\",{children:status===\"processing\"?/*#__PURE__*/_jsx(Button,{size:\"sm\",onClick:()=>markShipped(_id,owner===null||owner===void 0?void 0:owner._id),children:\"Mark as shipped\"}):/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:\"Shipped\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{style:{cursor:\"pointer\"},onClick:()=>showOrder(products),children:[\"View order \",/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-eye\"})]})})]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Table,{responsive:true,striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Client Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Items\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Order Total\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Address\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsx(Pagination,{data:orders,RenderComponent:TableRow,pageLimit:1,dataLimit:10,tablePagination:true})})]}),/*#__PURE__*/_jsxs(Modal,{show:show,onHide:handleClose,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Order details\"})}),orderToShow.map(order=>/*#__PURE__*/_jsxs(\"div\",{className:\"order-details__container d-flex justify-content-around py-2\",children:[/*#__PURE__*/_jsx(\"img\",{src:order.pictures[0].url,style:{maxWidth:100,height:100,objectFit:\"cover\"}}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[order.count,\" x \"]}),\" \",order.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Price: $\",Number(order.price)*order.count]})]})),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"})})]})]});}export default OrdersAdminPage;","map":{"version":3,"names":["React","useEffect","useState","Badge","Button","Modal","Table","useSelector","axios","Loading","Pagination","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","OrdersAdminPage","orders","setOrders","loading","setLoading","products","state","orderToShow","setOrderToShow","show","setShow","handleClose","markShipped","orderId","ownerId","patch","concat","then","_ref","data","catch","e","console","log","showOrder","productsObj","productsToShow","filter","product","_id","map","productCopy","count","description","get","_ref2","length","className","children","TableRow","_ref3","owner","total","status","address","name","size","onClick","bg","style","cursor","responsive","striped","bordered","hover","RenderComponent","pageLimit","dataLimit","tablePagination","onHide","Header","closeButton","Title","order","src","pictures","url","maxWidth","height","objectFit","Number","price","Footer","variant"],"sources":["C:/Users/91637/OneDrive/Desktop/E-commerce/frontend/src/components/OrdersAdminPage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Badge, Button, Modal, Table } from \"react-bootstrap\";\r\nimport { useSelector } from \"react-redux\";\r\nimport axios from \"../axios\";\r\nimport Loading from \"./Loading\";\r\nimport Pagination from \"./Pagination\";\r\n\r\nfunction OrdersAdminPage() {\r\n    const [orders, setOrders] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const products = useSelector((state) => state.products);\r\n    const [orderToShow, setOrderToShow] = useState([]);\r\n    const [show, setShow] = useState(false);\r\n\r\n    const handleClose = () => setShow(false);\r\n\r\n    function markShipped(orderId, ownerId) {\r\n        axios\r\n            .patch(`/orders/${orderId}/mark-shipped`, { ownerId })\r\n            .then(({ data }) => setOrders(data))\r\n            .catch((e) => console.log(e));\r\n    }\r\n\r\n    function showOrder(productsObj) {\r\n        let productsToShow = products.filter((product) => productsObj[product._id]);\r\n        productsToShow = productsToShow.map((product) => {\r\n            const productCopy = { ...product };\r\n            productCopy.count = productsObj[product._id];\r\n            delete productCopy.description;\r\n            return productCopy;\r\n        });\r\n        console.log(productsToShow);\r\n        setShow(true);\r\n        setOrderToShow(productsToShow);\r\n    }\r\n\r\n    useEffect(() => {\r\n        setLoading(true);\r\n        axios\r\n            .get(\"/orders\")\r\n            .then(({ data }) => {\r\n                setLoading(false);\r\n                setOrders(data);\r\n            })\r\n            .catch((e) => {\r\n                setLoading(false);\r\n            });\r\n    }, []);\r\n\r\n    if (loading) {\r\n        return <Loading />;\r\n    }\r\n\r\n    if (orders.length === 0) {\r\n        return <h1 className=\"text-center pt-4\">No orders yet</h1>;\r\n    }\r\n\r\n    function TableRow({ _id, count, owner, total, status, products, address }) {\r\n        return (\r\n            <tr>\r\n                <td>{_id}</td>\r\n                <td>{owner?.name}</td>\r\n                <td>{count}</td>\r\n                <td>{total}</td>\r\n                <td>{address}</td>\r\n                <td>\r\n                    {status === \"processing\" ? (\r\n                        <Button size=\"sm\" onClick={() => markShipped(_id, owner?._id)}>\r\n                            Mark as shipped\r\n                        </Button>\r\n                    ) : (\r\n                        <Badge bg=\"success\">Shipped</Badge>\r\n                    )}\r\n                </td>\r\n                <td>\r\n                    <span style={{ cursor: \"pointer\" }} onClick={() => showOrder(products)}>\r\n                        View order <i className=\"fa fa-eye\"></i>\r\n                    </span>\r\n                </td>\r\n            </tr>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Table responsive striped bordered hover>\r\n                <thead>\r\n                    <tr>\r\n                        <th>#</th>\r\n                        <th>Client Name</th>\r\n                        <th>Items</th>\r\n                        <th>Order Total</th>\r\n                        <th>Address</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <Pagination data={orders} RenderComponent={TableRow} pageLimit={1} dataLimit={10} tablePagination={true} />\r\n                </tbody>\r\n            </Table>\r\n\r\n            <Modal show={show} onHide={handleClose}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>Order details</Modal.Title>\r\n                </Modal.Header>\r\n                {orderToShow.map((order) => (\r\n                    <div className=\"order-details__container d-flex justify-content-around py-2\">\r\n                        <img src={order.pictures[0].url} style={{ maxWidth: 100, height: 100, objectFit: \"cover\" }} />\r\n                        <p>\r\n                            <span>{order.count} x </span> {order.name}\r\n                        </p>\r\n                        <p>Price: ${Number(order.price) * order.count}</p>\r\n                    </div>\r\n                ))}\r\n                <Modal.Footer>\r\n                    <Button variant=\"secondary\" onClick={handleClose}>\r\n                        Close\r\n                    </Button>\r\n                </Modal.Footer>\r\n            </Modal>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default OrdersAdminPage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}